%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Signal Processing Laboratory (LTS5) - EPFL      %
% LaTeX student report template                   %
% Authors:                                        %
%   D. Perdios – dimitris.perdios@epfl.ch         %
%   A. Besson – adrien.besson@epfl.ch             %
% v0.1 - 22.12.16                                 %
% Typeset configuration: pdfLaTeX + Biber         %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{The dataset}
\label{chap:dataset}

\section{General considerations}
\label{sec:gen_cons}
The voice gender dataset\footnote{\url{https://www.kaggle.com/primaryobjects/voicegender}} consists of features extracted from \num{3168} recorded voice samples, collected from male and female speakers. 
The features have been computed using tuneR\footnote{\url{https://cran.r-project.org/web/packages/tuneR/tuneR.pdf}} and seewave\footnote{\url{https://cran.r-project.org/web/packages/seewave/seewave.pdf}}, two acoustic analysis packages of R.

The dataset takes the form of a csv files where each row is composed of the following acoustical features of each voice:
\begin{itemize}
	\item \textbf{meanfreq:} mean frequency (in kHz)
	\item \textbf{sd:} standard deviation of frequency
	\item \textbf{median:} median frequency (in kHz)
	\item \textbf{Q25:} first quantile (in kHz)
	\item \textbf{Q75:} third quantile (in kHz)
	\item \textbf{IQR:} interquantile range (in kHz)
	\item \textbf{skew:} skewness of the spectrum
	\item \textbf{kurt:} kurtosis
	\item \textbf{sp.ent:} spectral entropy
	\item \textbf{sfm:} spectral flatness
	\item \textbf{mode:} mode frequency
	\item \textbf{centroid:} frequency centroid 
	\item \textbf{peakf:} peak frequency (frequency with highest energy)
	\item \textbf{meanfun:} average of fundamental frequency measured across acoustic signal
	\item \textbf{minfun:} minimum fundamental frequency measured across acoustic signal
	\item \textbf{maxfun:} maximum fundamental frequency measured across acoustic signal
	\item \textbf{meandom:} average of dominant frequency measured across acoustic signal
	\item \textbf{mindom:} minimum of dominant frequency measured across acoustic signal
	\item \textbf{maxdom:} maximum of dominant frequency measured across acoustic signal
	\item \textbf{dfrange:} range of dominant frequency measured across acoustic signal
	\item \textbf{modindx:} modulation index. Calculated as the accumulated absolute difference between adjacent measurements of fundamental frequencies divided by the frequency range
	\item \textbf{label:} male or female
\end{itemize}

The features are all quantitative and represents frequency characteristics of the voices.
\section{Description of the features}
\label{sec:feat_desc}
Before starting the data analysis, it is important to perfectly understand the features involved in the exercise. This will be very useful in a preprocessing step, since it will allow us to remove collinear features. It will also be a great asset when it will come to the analysis of the most important features in the gender recognition.

As already pointed out in Section~\ref{sec:gen_cons}, the extracted features are all related to the spectrum. 
\paragraph{Frequency-related features}
The mean frequency corresponds to a weighted average of the frequency by the amplitude of the spectral components:
\begin{equation}
\mu_f = \sum\limits_{i=1}^{N} f_i y_i ,
\end{equation} 
where $N$ is the number of frequency components of the spectrum, $f_i$ is the i-th frequency and $y_i$ is the relative amplitude of the i-th component of the spectrum. 
As described in p.\num{163} of the seewave documentation, it is equal to the feature 'centroid'.
The standard deviation is calculated as:
\begin{equation}
\sigma_f = \sqrt{\sum\limits_{i=1}^{N}y_i \left(f_i-\mu_f\right)^2}
\end{equation}

The median frequency is calculated as the frequency where the spectrum is divided into frequency intervals of same energy. The calculation of the quartiles are based on the same criterion. The interquartile range is calculated as the difference between the third and the first quartile.

The feature 'mode' characterizes the dominant frequency of the spectrum, \ie the one with the highest amplitude. It is very similar to the peak frequency which corresponds to the frequency with the highest energy. The fundamental frequency is the lowest frequency of the spectrum.

The features 'meanfun', 'minfun', 'maxfun', 'meandom', 'maxdom', 'mindom', 'dfrange' and 'modindx' are based on short-time Fourier transform applied on segments of fixed durations, small compared to the duration of the whole signal. This permits to have features more localized in time.

In addition to the frequency-related features, we can find measures on the shape of the spectrum which may give very interesting additional information. 
\paragraph{Skewness of the spectrum}
The skewness of the spectrum is a measure of its asymmetry around the mean frequency. It is calculated as follows:
\begin{equation}
\label{eq_skew}
	S = \frac{1}{\sigma_f^3}\frac{\sum\limits_{i=1}^{N} \left(f_i - \mu_f\right)^3}{N-1}.
\end{equation}
From~\eqref{eq_skew}, it is clear that the sign of $S$ gives information of the left or right asymmetry of the spectrum while the absolute value of $S$ gives the strength of the asymmetry. 
\paragraph{Kurtosis}
The Kurtosis is a measure of the "tailedness" of a probability distribution. It is calculated as the fourth order moment of the frequency distribution, described below:
\begin{equation}
\label{eq_kurtosis}
	K = \frac{1}{\sigma_f^4}\frac{\sum\limits_{i=1}^{N} \left(f_i - \mu_f\right)^4}{N-1}.
\end{equation}
When $K=3$, the frequency distribution is normal. When $K<3$, the frequency distribution is said to be \textit{platikurtic}, it has fewer items around the means than in the tails, compared to a normal distribution. When $K>3$, the distribution is said to be \textit{leptokurtic} and has more frequency around the mean than in the tails, compared to a normal distribution.
\paragraph{Shannon spectral entropy}
The Shannon entropy is used to discriminate whether the voice signal is noisy or pure~\cite{Nunes2004}. it is calculated as follows:
\begin{equation}
\label{eq:entropy}
	H = \frac{-\sum\limits_{i=1}^{N} y_i \log_2 \left(y_i\right)}{\log_2 \left(N\right)}
\end{equation}

If the signal is pure, then all the energy is concentrated in one frequency component, let us say the j-th component for which $y_j = 1$. In this case, $H=0$. If the signal is a white noise, then $y_i = 1/N, \; \forall i \in \left\lbrace 1,...,N \right\rbrace$ and $H=1$.
\paragraph{Spectral flatness}
The spectral flatness is rather similar to the spectral entropy. It is measured as the ratio between the geometric mean and the arithmetic mean:
\begin{equation}
\label{eq:spec_flat}
	F = N \frac{\sqrt[N]{\prod\limits_{i=1}^{N} y_i}}{\sum \limits_{i=1}^{N} y_i}.
\end{equation}
In case of a white noise, the spectrum is flat and $H=1$. In case of a pure tone, the geometrical mean is equal to zero and $H=0$.

\section{Cleaning the dataset}
\label{sec_cleaning_dataset}
From the description of the features given in Section~\ref{sec:feat_desc}, a first cleaning of the dataset may be achieved before starting the analysis.
Indeed, several features are exactly the same of collinear:
\begin{itemize}
	\item The features 'meanfreq' and 'centroid' are exactly similar. So 'centroid' has been removed;
	\item The following relationship holds: $ 'IQR' = 'Q75' - 'Q25'$. 'IQR' has been removed.
	\item The following relationship holds: $ 'dfrange' = 'maxdom' - 'mindom'$. 'dfrange' has been removed.
\end{itemize}
%\chapter{Another chapter with the same figures etc.}
%\label{chap:examples_more}
%
%\section{More figures}
%\label{sec:figures_more}
%
%\subsection{A central figure}
%\label{subsec:central_figure_more}
%\begin{figure}[htb]
%	\centering
%	\includegraphics[width=\textwidth]{sim_input_exp_measurements_wb_pc_pfld.pdf}
%	\caption[A fullwidth central figure (short caption).]{A fullwidth central figure with a long caption which is unlikely in the list of figures. Therefore one should use the option argument of caption to define a short caption version}
%	\label{fig:central_figure_more}
%\end{figure}
%
%\subsection{A figure with subfigures (more)}
%\label{subsec:subfigureA_more}
%\begin{figure}[htp]
%%	% Global scale inside
%%	\newcommand{\SubFigScal}{0.35}
%%	% Compute lengths inside \begin{figure} and \end{figure} so they are erased after
%%	%	Width depending on the fixed scale
%%	\newlength{\TriSubFigWidthA}
%%	\settowidth{\TriSubFigWidthA}{\includegraphics[scale=\SubFigScal]{sim_input_ampl.pdf}}
%%	\newlength{\TriSubFigWidthB}
%%	\settowidth{\TriSubFigWidthB}{\includegraphics[scale=\SubFigScal]{sim_input_exp_measurements_wb_gf_pfld.pdf}}
%%	\newlength{\TriSubFigWidthC}
%%	\settowidth{\TriSubFigWidthC}{\includegraphics[scale=\SubFigScal]{sim_input_tdel.pdf}}
%%	\newlength{\TriSubFigWidthD}
%%	\settowidth{\TriSubFigWidthD}{\includegraphics[scale=\SubFigScal]{sim_input_exp_measurements_wb_pc_pfld.pdf}}
%	
%	\null\hfill% <- starting the horizontal equi-spacing (the % is mandatory!)
%	\begin{subfigure}[b]{\TriSubFigWidthA}
%		\centering
%		\includegraphics[width=\textwidth]{sim_input_ampl.pdf}
%		\caption{}
%	\end{subfigure}%
%	\hfill% <- horizontal equi-spacing (the % is mandatory!)
%	\begin{subfigure}[b]{\TriSubFigWidthB}
%		\centering
%		\includegraphics[width=\textwidth]{sim_input_exp_measurements_wb_gf_pfld.pdf}
%		\caption{}
%	\end{subfigure}%
%	\hfill\null% <- ending the horizontal equi-spacing (the % is mandatory!) 
%	
%	\null\hfill% <- starting the horizontal equi-spacing (the % is mandatory!)
%	\begin{subfigure}[b]{\TriSubFigWidthC}
%		\centering
%		\includegraphics[width=\textwidth]{sim_input_tdel.pdf}
%		\caption{}
%	\end{subfigure}%
%	\hfill% <- horizontal equi-spacing (the % is mandatory!)
%	\begin{subfigure}[b]{\TriSubFigWidthD}
%		\centering
%		\includegraphics[width=\textwidth]{sim_input_exp_measurements_wb_pc_pfld.pdf}
%		\caption{}
%	\end{subfigure}%
%	\hfill\null% <- ending the horizontal equi-spacing (the % is mandatory!) 
%	\caption[A figure containing 4 different subfigures of different height and width.]{A figure containing 4 different subfigures of different height and width. (b) and (d) are, at the same scale, higher and wider than (a) and (d). Fixing the same scale, it is possible to compute their respective width in order to have them aligned (on the bottom).}
%	\label{fig:subfigureA_more}
%\end{figure}
%
%\subsection{Another figure with subfigures}
%\label{subsec:subfigureB_more}
%
%\begin{figure}[htb]
%%	% Compute lengths inside \begin{figure} and \end{figure} so they are erased after
%%	\newlength{\OccSubFigWidth} \setlength{\OccSubFigWidth}{0.15\textwidth}
%%	\newlength{\OccSubFigHeight}
%%	\settoheight{\OccSubFigHeight}{\includegraphics[width=\OccSubFigWidth]{figures/Simulation_UFSB_classic_1PW.pdf}}
%%	\newlength{\OccSubFigWidthCBar}
%%	\settowidth{\OccSubFigWidthCBar}{\includegraphics[height=\OccSubFigHeight]{figures/Simulation_Lu_sparse_1PW.pdf}}
%
%	\hfill% <- starting the horizontal equi-spacing (the % is mandatory!)
%%	\null\hfill% <- starting the horizontal equi-spacing (the % is mandatory!)
%	\begin{subfigure}[c]{\OccSubFigWidth}
%		\centering
%		\includegraphics[width=\textwidth]{figures/Simulation_UFSB_classic_1PW.pdf}
%		\caption{}
%		\label{subfig:subfigureB_a_more}
%	\end{subfigure}%
%	\hfill% <- horizontal equi-spacing (the % is mandatory!)
%	\begin{subfigure}[c]{\OccSubFigWidth}
%		\centering
%		\includegraphics[width=\textwidth]{figures/Simulation_Garcia_classic_1PW.pdf}
%		\caption{}
%		\label{subfig:subfigureB_b_more}
%	\end{subfigure}%
%	\hfill% <- horizontal equi-spacing (the % is mandatory!)
%	\begin{subfigure}[c]{\OccSubFigWidth}
%		\centering
%		\includegraphics[width=\textwidth]{figures/Simulation_Lu_classic_1PW.pdf}
%		\caption{}
%		\label{subfig:subfigureB_c_more}
%	\end{subfigure}%
%	\hfill% <- horizontal equi-spacing (the % is mandatory!)
%	\begin{subfigure}[c]{\OccSubFigWidth}
%		\centering
%		\includegraphics[width=\textwidth]{figures/Simulation_UFSB_sparse_1PW.pdf}
%		\caption{}
%		\label{subfig:subfigureB_d_more}
%	\end{subfigure}%
%	\hfill% <- horizontal equi-spacing (the % is mandatory!)
%	\begin{subfigure}[c]{\OccSubFigWidth}
%		\centering
%		\includegraphics[width=\textwidth]{figures/Simulation_Garcia_sparse_1PW.pdf}
%		\caption{}
%		\label{subfig:subfigureB_e_more}
%	\end{subfigure}%
%	\hfill% <- horizontal equi-spacing (the % is mandatory!)
%	\begin{subfigure}[c]{\OccSubFigWidthCBar}
%		\centering
%		\includegraphics[width=\textwidth]{figures/Simulation_Lu_sparse_1PW.pdf}
%		\caption{}
%		\label{subfig:subfigureB_f_more}
%	\end{subfigure}%
%	\hfill\null% <- ending the horizontal equi-spacing (the % is mandatory!) 
%	\caption[A maximized subfigure]{A maximized subfigure with a lot of subfigure on the same line. Usually captions are not used in subfigures, they are defined in the global caption of the figure}
%	\label{fig:subfigureB_more}
%\end{figure}
%
%\section{Some tables}
%\label{sec:tables_more}
%
%\begin{table}[htb]
%\centering
%\caption[A nice looking simple table with tabu and booktabs packages]{A nice looking simple table with tabu and booktabs packages. Usually it is better to put the table caption before the table itself.}
%\begin{tabu}{lcccc}
%\toprule
%Sample & A & B & C & D \\
%\midrule
%S1 & 5 & 8 & 12 & 2 \\
%S2 & 6 & 9 & 2 & 6 \\
%S3 & 7 & 9 & 5 & 8 \\
%S4 & 8 & 9 & 8 & 2 \\
%\bottomrule
%\end{tabu}
%\end{table}
%
%\begin{table}[htb]
%\centering
%\caption[Same table with fixed length]{Same table with fixed length with adaptable column width.}
%\begin{tabu} to 0.7\textwidth {X[2,L] X[1,C] X[1,C] X[1,C] X[1,C]}
%\toprule
%Sample & A & B & C & D \\
%\midrule
%S1 & 5 & 8 & 12 & 2 \\
%S2 & 6 & 9 & 2 & 6 \\
%S3 & 7 & 9 & 5 & 8 \\
%S4 & 8 & 9 & 8 & 2 \\
%\bottomrule
%\end{tabu}
%\end{table}
%
%\begin{table}[htb]
%\centering
%\caption[A nice looking table]{A nice looking table with tabu and booktabs packages.}
%\begin{tabu}{rrrrcrrr}
%\toprule
%& \multicolumn{3}{c}{$w = 8$} & \phantom{abc}& \multicolumn{3}{c}{$w = 16$}\\ \cmidrule{2-4} \cmidrule{6-8}
%& $t=0$ & $t=1$ & $t=2$ && $t=0$ & $t=1$ & $t=2$\\ \midrule
%$\text{dir}=1$\\
%$c_{\text{top,}0}$ & 0.0790 & 0.1692 & 0.2945 && 0.3670 & 0.7187 & 3.1815\\
%$c_{\text{top,}1}$ & -0.8651& 50.0476& 5.9384&& -9.0714& 297.0923& 46.2143\\
%$c_{\text{top,}2}$ & 124.2756& -50.9612& -14.2721&& 128.2265& -630.5455& -381.0930\\
%$\text{dir}=0$\\
%$c_{\text{top,}0}$ & 0.0357& 1.2473& 0.2119&& 0.3593& -0.2755& 2.1764\\
%$c_{\text{top,}1}$ & -17.9048& -37.1111& 8.8591&& -30.7381& -9.5952& -3.0000\\
%$c_{\text{top,}2}$ & 105.5518& 232.1160& -94.7351&& 100.2497& 141.2778& -259.7326\\ \bottomrule
%\end{tabu}
%\end{table}
%
%%TODO: error on the display of the cmidrule compared to the other
%%TODO:spacing under \textiwdth tabu not the same
%\begin{table}[htb]
%\centering
%\caption[Same complex table with fixed length]{A nice looking table with tabu and booktabs packages.}
%\begin{tabu} to \textwidth {X[1,R]X[1,R]X[1,R]X[1,R]X[0.1,C]X[1,R]X[1,R]X[1,R]}
%\toprule
%& \multicolumn{3}{c}{$w = 8$} & \phantom{abc}& \multicolumn{3}{c}{$w = 16$}\\ %\cmidrule{2-4} \cmidrule{6-8}
%& $t=0$ & $t=1$ & $t=2$ && $t=0$ & $t=1$ & $t=2$\\ \midrule
%$\text{dir}=1$\\
%$c_{\text{top,}0}$ & 0.0790 & 0.1692 & 0.2945 && 0.3670 & 0.7187 & 3.1815\\
%$c_{\text{top,}1}$ & -0.8651& 50.0476& 5.9384&& -9.0714& 297.0923& 46.2143\\
%$c_{\text{top,}2}$ & 124.2756& -50.9612& -14.2721&& 128.2265& -630.5455& -381.0930\\
%$\text{dir}=0$\\
%$c_{\text{top,}0}$ & 0.0357& 1.2473& 0.2119&& 0.3593& -0.2755& 2.1764\\
%$c_{\text{top,}1}$ & -17.9048& -37.1111& 8.8591&& -30.7381& -9.5952& -3.0000\\
%$c_{\text{top,}2}$ & 105.5518& 232.1160& -94.7351&& 100.2497& 141.2778& -259.7326\\ \bottomrule
%\end{tabu}
%\end{table}
%
%\section{Some algorithms}
%\label{sec:algorithms_more}
%\begin{algorithm}
%\caption{A simple algorithm}
%\begin{algorithmic}
%\If {$i\geq maxval$}
%    \State $i\gets 0$
%\Else
%    \If {$i+k\leq maxval$}
%        \State $i\gets i+k$
%    \EndIf
%\EndIf
%\end{algorithmic}
%\end{algorithm}
%
%\begin{algorithm}
%\caption{Euclid’s algorithm}\label{euclid_more}
%\begin{algorithmic}[1]
%\Procedure{Euclid}{$a,b$}\Comment{The g.c.d. of a and b}
%   \State $r\gets a\bmod b$
%   \While{$r\not=0$}\Comment{We have the answer if r is 0}
%      \State $a\gets b$
%      \State $b\gets r$
%      \State $r\gets a\bmod b$
%   \EndWhile\label{euclidendwhile_more}
%   \State \textbf{return} $b$\Comment{The gcd is b}
%\EndProcedure
%\end{algorithmic}
%\end{algorithm}
%
%\section{Some references calls}
%\label{sec:references_calls_more}
%Cite and specific article~\cite{Besson_EUSIPCO_2016}.
%Cite a multiple articles~\cite{Besson_EUSIPCO_2016,Besson_ICIP_2016,Carrillo_SPL_2013}. This one is a book~\cite{Morse_1968}.
%You can also cite the authors~\citeauthor{Besson_ICIP_2016} and relate to the article~\cite{Besson_ICIP_2016}.
%A citation with a doi (journal) and arxiv~\cite{Chernyakova_UFFC_2014} so the arxiv is not printed.
%Only arxiv~\cite{Yankelevsky_ARXIV_2016}.
%With acronyms~\cite{Paik_OE_2007} and more complicated ones~\cite{Schor_CASES_2014,Schor_ESTIM_2013}.
%Some other references to span multiple pages~\cite{IEEEexample:incollection,IEEEexample:incollectionwithseries,IEEEexample:incollectionmanyauthors,IEEEexample:jppat,IEEEexample:uspat,IEEEexample:electronhowinfo2,IEEEexample:confwithpaper,IEEEexample:techreptype,IEEEexample:book,IEEEexample:bookwithseriesvolume,IEEEexample:bookwitheditor,IEEEexample:inbookpagesnote,IEEEexample:masters,IEEEexample:frenchpatreq,IEEEexample:motmanual}.
%A last exemple with a huge amount of authors~\cite{Waterston_NATURE_2002} and the author citation~\citeauthor{Waterston_NATURE_2002}.
%
%
%
